# 画像操作

note-mcpでは、記事の画像を3つの方法で操作できます。

## サポートされる形式

| 形式 | MIME Type |
|------|-----------|
| JPEG | image/jpeg |
| PNG | image/png |
| GIF | image/gif |
| WebP | image/webp |

**最大ファイルサイズ**: 10MB

## アイキャッチ画像

`note_upload_eyecatch`ツールで記事の見出し（アイキャッチ）画像をアップロードします。

```
記事ID 12345678 にアイキャッチ画像をアップロードしてください:
/path/to/header.jpg
```

アップロードした画像は自動的に記事の見出し画像として設定されます。

### パラメータ

| パラメータ | 説明 |
|-----------|------|
| `file_path` | アップロードする画像ファイルのパス |
| `note_id` | 画像を関連付ける記事のID（数字のみ） |

## 本文用画像のアップロード

`note_upload_body_image`ツールで本文埋め込み用の画像をアップロードします。

```
記事ID 12345678 に本文用画像をアップロードしてください:
/path/to/figure.png
```

**重要**: このツールは画像をアップロードしてURLを返すだけです。画像を記事に直接挿入するには`note_insert_body_image`を使用してください。

### パラメータ

| パラメータ | 説明 |
|-----------|------|
| `file_path` | アップロードする画像ファイルのパス |
| `note_id` | 画像を関連付ける記事のID（数字のみ） |

### レスポンス例

```
本文用画像をアップロードしました。URL: https://assets.st-note.com/...
※画像を記事に直接挿入するには note_insert_body_image を使用してください。
```

## 本文への画像挿入

`note_insert_body_image`ツールでブラウザ経由で画像を記事本文に直接挿入します。

```
記事キー n1234567890ab に画像を挿入してください:
/path/to/diagram.png
キャプション: 図1. システム構成図
```

### なぜブラウザ経由か

note.comのAPIでは画像のHTML埋め込みが正しく保存されないため、このツールはブラウザ自動化を使用してエディタの「画像を追加」機能を操作します。

### パラメータ

| パラメータ | 説明 |
|-----------|------|
| `file_path` | 挿入する画像ファイルのパス |
| `article_key` | 画像を挿入する記事のキー（例: n1234567890ab） |
| `caption` | 画像のキャプション（オプション） |

### 動作

1. Chromiumブラウザが起動し、記事の編集画面を開きます
2. エディタ末尾に移動します
3. 「画像を追加」機能を使用して画像をアップロードします
4. キャプションが指定されている場合、入力します
5. ブラウザは自動的に閉じられます

## 画像操作の比較

| ツール | 用途 | 方法 |
|--------|------|------|
| `note_upload_eyecatch` | アイキャッチ画像 | API |
| `note_upload_body_image` | 画像URLの取得 | API |
| `note_insert_body_image` | 本文への画像挿入 | ブラウザ自動化 |

## 記事IDの確認

画像操作には記事ID（数字のみ）が必要です。`note_list_articles`で記事一覧を取得し、IDを確認できます。

```
記事一覧を取得してください
```

## エラーハンドリング

### ファイルが見つからない

```
File not found: /path/to/image.jpg
```

→ ファイルパスを確認してください

### ファイル形式が無効

```
Invalid file format: .bmp. Allowed formats: .gif, .jpeg, .jpg, .png, .webp
```

→ サポートされる形式に変換してください

### ファイルサイズ超過

```
File size (15000000 bytes) exceeds maximum allowed size (10485760 bytes)
```

→ 10MB以下に圧縮してください

## ワークフロー例

### 記事作成から画像設定まで

1. 下書き記事を作成：
   ```
   タイトル「画像付き記事」で下書きを作成してください
   ```

2. 記事キーを確認：
   ```
   下書き記事の一覧を取得してください
   ```

3. アイキャッチ画像を設定：
   ```
   記事ID 12345678 にアイキャッチ画像を設定:
   /path/to/header.jpg
   ```

4. 本文に画像を挿入：
   ```
   記事キー n1234567890ab に画像を挿入:
   /path/to/figure.png
   キャプション: 図1の説明
   ```

5. プレビューで確認：
   ```
   記事 n1234567890ab のプレビューを表示してください
   ```
