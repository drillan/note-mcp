# MCPツールリファレンス

note-mcpが提供する17のMCPツールのリファレンスです。

## 認証ツール

### note_login

note.comにログインします。

```
note_loginを実行してください
```

**パラメータ**

| 名前 | 型 | 必須 | デフォルト | 説明 |
|------|-----|------|------------|------|
| `timeout` | int | いいえ | 300 | ログインのタイムアウト時間（秒） |

**動作**

1. Chromiumブラウザが起動
2. note.comのログインページを表示
3. ユーザーが手動でログイン情報を入力
4. 認証Cookie取得後、セッション情報を保存
5. ブラウザを閉じる

**戻り値**

```
ログインに成功しました。ユーザー名: your_username
```

---

### note_check_auth

現在の認証状態を確認します。

```
認証状態を確認してください
```

**パラメータ**

なし

**戻り値**

| 状態 | メッセージ |
|------|-----------|
| 認証済み | `認証済みです。ユーザー名: your_username` |
| 未認証 | `未認証です。note_loginを使用してログインしてください。` |
| 期限切れ | `セッションの有効期限が切れています。note_loginで再ログインしてください。` |

---

### note_logout

note.comからログアウトします。

```
ログアウトしてください
```

**パラメータ**

なし

**戻り値**

```
ログアウトしました。
```

---

### note_set_username

ユーザー名を手動で設定します。

```
ユーザー名を your_username に設定してください
```

**パラメータ**

| 名前 | 型 | 必須 | 説明 |
|------|-----|------|------|
| `username` | str | はい | note.comのユーザー名（URLに表示される名前） |

**用途**

ログイン時にユーザー名の自動取得に失敗した場合に使用します。ユーザー名はnote.comのプロフィールURL（`https://note.com/your_username`）から確認できます。

**戻り値**

```
ユーザー名を 'your_username' に設定しました。
```

---

## 記事操作ツール

### note_create_draft

note.comに下書き記事を作成します。

```
以下の内容でnote.comに下書きを作成してください:

タイトル: AIと記事を書く
本文:
# はじめに
AIアシスタントと一緒に記事を書いてみましょう。

タグ: AI, 執筆
```

**パラメータ**

| 名前 | 型 | 必須 | 説明 |
|------|-----|------|------|
| `title` | str | はい | 記事のタイトル |
| `body` | str | はい | 記事の本文（Markdown形式） |
| `tags` | list[str] | いいえ | 記事のタグ（#なしでも可） |

**動作**

API経由でnote.comに下書き記事を作成します。Markdownは自動的にnote.com互換のHTMLに変換されます。

**戻り値**

```
下書きを作成しました。ID: 12345678、キー: n1234567890ab、タグ: AI, 執筆
```

---

### note_get_article

記事の内容を取得します。

```
記事ID n1234567890ab の内容を取得してください
```

**パラメータ**

| 名前 | 型 | 必須 | 説明 |
|------|-----|------|------|
| `article_id` | str | はい | 取得する記事のID |

**戻り値**

```
記事を取得しました。

タイトル: AIと記事を書く
ステータス: draft
タグ: AI, 執筆

本文:
# はじめに
AIアシスタントと一緒に記事を書いてみましょう。
```

---

### note_update_article

既存の記事を更新します。

```
記事ID n1234567890ab を以下の内容で更新してください:

タイトル: 更新されたタイトル
本文:
# 新しい内容
...
```

**パラメータ**

| 名前 | 型 | 必須 | 説明 |
|------|-----|------|------|
| `article_id` | str | はい | 更新する記事のID |
| `title` | str | はい | 新しいタイトル |
| `body` | str | はい | 新しい本文（Markdown形式） |
| `tags` | list[str] | いいえ | 新しいタグ（#なしでも可） |

**推奨ワークフロー**

1. `note_get_article`で既存内容を取得
2. 取得した内容を確認・編集
3. `note_update_article`で更新を保存

**戻り値**

```
記事を更新しました。ID: 12345678、タグ: AI, 執筆
```

---

### note_publish_article

記事を公開します。

```
記事ID 12345678 を公開してください
```

**パラメータ**

| 名前 | 型 | 必須 | 説明 |
|------|-----|------|------|
| `article_id` | str | いいえ | 公開する下書き記事のID（新規作成時は省略） |
| `title` | str | いいえ | 記事タイトル（新規作成時は必須） |
| `body` | str | いいえ | 記事本文（Markdown形式、新規作成時は必須） |
| `tags` | list[str] | いいえ | 記事のタグ |

**使用パターン**

1. **既存の下書きを公開**: `article_id`を指定
2. **新規作成と同時に公開**: `title`と`body`を指定

**戻り値**

```
記事を公開しました。ID: 12345678、URL: https://note.com/username/n1234567890ab
```

---

### note_list_articles

自分の記事一覧を取得します。

```
下書き記事の一覧を取得してください
```

**パラメータ**

| 名前 | 型 | 必須 | デフォルト | 説明 |
|------|-----|------|------------|------|
| `status` | str | いいえ | all | フィルタするステータス（draft/published/all） |
| `page` | int | いいえ | 1 | ページ番号（1から開始） |
| `limit` | int | いいえ | 10 | 1ページあたりの記事数（最大10） |

**戻り値**

```
記事一覧（25件中10件、ページ1）:
  - [下書き] AIと記事を書く (ID: 12345678)
  - [公開済み] プログラミング入門 (ID: 87654321)
  ...
  （続きはpage=2で取得できます）
```

---

### note_show_preview

記事のプレビューをブラウザで表示します。

```
記事 n1234567890ab のプレビューを表示してください
```

**パラメータ**

| 名前 | 型 | 必須 | 説明 |
|------|-----|------|------|
| `article_key` | str | はい | プレビューする記事のキー（例: n1234567890ab） |

**動作**

下書き記事の場合、プレビュー用アクセスキーを使用して表示します。

**戻り値**

```
プレビューを表示しました。記事キー: n1234567890ab
```

---

## 画像ツール

### note_upload_eyecatch

記事のアイキャッチ（見出し）画像をアップロードします。

```
記事ID 12345678 にアイキャッチ画像をアップロードしてください:
/path/to/header.jpg
```

**パラメータ**

| 名前 | 型 | 必須 | 説明 |
|------|-----|------|------|
| `file_path` | str | はい | アップロードする画像ファイルのパス |
| `note_id` | str | はい | 画像を関連付ける記事のID（数字のみ） |

**サポート形式**: JPEG, PNG, GIF, WebP（最大10MB）

**戻り値**

```
アイキャッチ画像をアップロードしました。URL: https://assets.st-note.com/...
```

---

### note_upload_body_image

記事本文内に埋め込む画像をアップロードします。

```
記事ID 12345678 に本文用画像をアップロードしてください:
/path/to/figure.png
```

**パラメータ**

| 名前 | 型 | 必須 | 説明 |
|------|-----|------|------|
| `file_path` | str | はい | アップロードする画像ファイルのパス |
| `note_id` | str | はい | 画像を関連付ける記事のID（数字のみ） |

**重要**: このツールは画像をアップロードしてURLを返すだけです。画像を記事に直接挿入するには`note_insert_body_image`を使用してください。

**戻り値**

```
本文用画像をアップロードしました。URL: https://assets.st-note.com/...

※画像を記事に直接挿入するには note_insert_body_image を使用してください。
```

---

### note_insert_body_image

記事本文内に画像を直接挿入します。

```
記事ID n1234567890ab に画像を挿入してください:
/path/to/diagram.png
キャプション: 図1. システム構成図
```

**パラメータ**

| 名前 | 型 | 必須 | 説明 |
|------|-----|------|------|
| `file_path` | str | はい | 挿入する画像ファイルのパス |
| `article_id` | str | はい | 画像を挿入する記事のID（数値またはキー形式） |
| `caption` | str | いいえ | 画像のキャプション |

**動作**

API経由で画像をアップロードし、記事本文に直接挿入します。

**戻り値**

```
画像を挿入しました。記事ID: n1234567890ab、キャプション: 図1. システム構成図
```

---

### note_get_preview_html

プレビューページのHTMLを取得します（ブラウザを開かずに取得）。

```
記事 n1234567890ab のプレビューHTMLを取得してください
```

**パラメータ**

| 名前 | 型 | 必須 | 説明 |
|------|-----|------|------|
| `article_key` | str | はい | 取得する記事のキー（例: n1234567890ab） |

**動作**

API経由でプレビューページのHTMLを取得します。ブラウザを起動せずにHTML内容を確認できます。

**戻り値**

```
プレビューHTMLを取得しました。

<html>...プレビューページのHTML...</html>
```

---

### note_create_from_file

Markdownファイルから下書き記事を作成します。

```
/path/to/article.md から記事を作成してください
```

**パラメータ**

| 名前 | 型 | 必須 | デフォルト | 説明 |
|------|-----|------|------------|------|
| `file_path` | str | はい | - | Markdownファイルのパス |
| `upload_images` | bool | いいえ | true | ローカル画像をアップロードするかどうか |

**ファイル形式**

YAMLフロントマターでメタデータを指定できます：

```markdown
---
title: 記事タイトル
tags:
  - タグ1
  - タグ2
---

# 本文

記事の本文...
```

フロントマターがない場合、最初のH1見出しがタイトルとして使用されます。

**画像の処理**

`upload_images: true`の場合、ローカル画像パス（`![alt](./images/photo.png)`）は自動的にアップロードされ、URLに置き換えられます。

**戻り値**

```
ファイルから下書きを作成しました。ID: 12345678、キー: n1234567890ab
```

---

### note_delete_draft

下書き記事を削除します（2段階確認）。

```
記事 n1234567890ab を削除してください
```

**パラメータ**

| 名前 | 型 | 必須 | デフォルト | 説明 |
|------|-----|------|------------|------|
| `article_key` | str | はい | - | 削除する記事のキー（例: n1234567890ab） |
| `confirm` | bool | いいえ | false | 削除を実行する場合はtrue、確認のみの場合はfalse |

**動作**

誤削除を防ぐため、2段階の確認プロセスを採用しています：

1. `confirm: false`で呼び出し → 削除対象の記事情報を表示
2. `confirm: true`で呼び出し → 実際に削除を実行

**戻り値**

確認時（`confirm: false`）：

```
以下の下書きを削除しますか？

タイトル: AIと記事を書く
キー: n1234567890ab

削除を実行するには confirm: true で再度呼び出してください。
```

実行時（`confirm: true`）：

```
下書きを削除しました。キー: n1234567890ab
```

---

### note_delete_all_drafts

すべての下書き記事を一括削除します（2段階確認）。

```
すべての下書きを削除してください
```

**パラメータ**

| 名前 | 型 | 必須 | デフォルト | 説明 |
|------|-----|------|------------|------|
| `confirm` | bool | いいえ | false | 削除を実行する場合はtrue、確認のみの場合はfalse |

**動作**

誤削除を防ぐため、2段階の確認プロセスを採用しています：

1. `confirm: false`で呼び出し → 削除対象の全下書き一覧を表示
2. `confirm: true`で呼び出し → 実際に全件削除を実行

**戻り値**

確認時（`confirm: false`）：

```
以下の5件の下書きを削除しますか？

- AIと記事を書く (n1234567890ab)
- プログラミング入門 (n2345678901bc)
...

削除を実行するには confirm: true で再度呼び出してください。
```

実行時（`confirm: true`）：

```
5件の下書きを削除しました。
```

---

## エラーレスポンス

すべてのツールは、セッションが無効な場合に以下のメッセージを返します：

```
セッションが無効です。note_loginでログインしてください。
```

APIエラーが発生した場合、エラーの詳細を含むメッセージが返されます。
