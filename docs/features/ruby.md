# ルビ（読み仮名）記法

note-mcpでは、日本語テキストにルビ（読み仮名）を追加できます。

## 基本的な使い方

### 記法

```markdown
｜漢字《かんじ》
```

縦棒（｜）の後に親文字、二重山括弧（《》）内に読み仮名を記述します。

### 例

```markdown
今日は｜東京《とうきょう》に行きます。
```

結果：今日は<ruby>東京<rp>（</rp><rt>とうきょう</rt><rp>）</rp></ruby>に行きます。

## 記法のバリエーション

### 全角縦棒

```markdown
｜漢字《かんじ》
```

全角の縦棒（｜）を使用できます。

### 半角縦棒

```markdown
|漢字《かんじ》
```

半角の縦棒（|）も使用できます。

### 縦棒省略

漢字・ひらがな・カタカナの連続の場合、縦棒を省略できます：

```markdown
漢字《かんじ》を読む
```

## 対応文字

ルビを付けられる親文字：

| 文字種 | 例 |
|--------|-----|
| 漢字 | 東京《とうきょう》 |
| ひらがな | あいう《アイウ》 |
| カタカナ | カタカナ《かたかな》 |

## 複数のルビ

1つの文に複数のルビを含められます：

```markdown
｜明日《あした》の｜天気《てんき》は｜晴《は》れです。
```

## HTMLへの変換

ルビ記法は以下のHTML形式に変換されます：

```html
<ruby>漢字<rp>（</rp><rt>かんじ</rt><rp>）</rp></ruby>
```

- `<ruby>`: ルビ要素
- `<rp>`: ルビ非対応ブラウザ用の括弧
- `<rt>`: ルビテキスト（読み仮名）

## 使用例

### 小説・創作

```markdown
「｜明日《あした》、｜私《わたし》は｜此処《ここ》を｜発《た》つ」
```

### 技術文書

```markdown
｜変数《へんすう》と｜関数《かんすう》について説明します。
```

### 学習教材

```markdown
｜猫《ねこ》が｜魚《さかな》を｜食《た》べる。
```

## 技術的詳細

### レンダリングの仕組み

1. **Markdown入力**: `｜漢字《かんじ》` 形式でルビを記述
2. **ブラウザパスで処理**: note-mcpがブラウザ自動化でエディタに入力
3. **サーバーサイド変換**: 記事保存時にnote.comのサーバーがルビ記法を処理
4. **HTMLレンダリング**: `<ruby>` タグとしてプレビュー/公開時に表示

### API制限

`<ruby>` タグをAPI経由で直接挿入することはできません。note.com APIがタグをサニタイズ（削除）します。

そのため、ルビ記法を含む記事はブラウザ自動化パスで処理されます。これはnote.comのサーバーサイドでルビ変換が行われるためです。

### エディタでの動作

ProseMirrorエディタでは、ルビ記法を入力してもエディタ上では変換されません。変換は記事保存時にサーバーサイドで行われます。

> 記事を下書き保存または公開するとルビが反映されます
> — [note.com公式ヘルプ](https://www.help-note.com/hc/ja/articles/4406430353817)

## 制限事項

- 親文字は漢字・ひらがな・カタカナに限定されます
- 英数字や記号には縦棒での明示が必要です
- 読み仮名に《》を含めることはできません
- API経由での`<ruby>`タグ挿入は不可（サニタイズされる）
